var Ge=Object.defineProperty,Ke=Object.defineProperties;var Ze=Object.getOwnPropertyDescriptors;var Te=Object.getOwnPropertySymbols;var qe=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable;var ve=(e,l,n)=>l in e?Ge(e,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[l]=n,T=(e,l)=>{for(var n in l||(l={}))qe.call(l,n)&&ve(e,n,l[n]);if(Te)for(var n of Te(l))Je.call(l,n)&&ve(e,n,l[n]);return e},b=(e,l)=>Ke(e,Ze(l));import{l as Qe,f as et,a as tt,b as lt,c as nt,d as at,e as rt,g as st,h as ot,i as ct,R as t,j as ut,u as N,k as K,r as Ne,m as it,t as mt,n as dt,o as p,p as Z,F as k,q as pt,_ as be,s as q,v as Et,w as ie,x as ft,S as yt,T as _e,y as Ct,C as me,z as J,B as U,A as ht,D as j,E as xt}from"./vendor.fe09a59f.js";const gt=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const h of s.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};gt();Qe.add(et,tt,lt,nt,at,rt,st,ot,ct);function de({value:e,backgroundColor:l,className:n="text-white"}){return t.createElement("span",{className:`font-weight-400 d-inline-block color-grey-800 border-radius-sm fa-sm text-transform-capitalize ${n}`,style:{backgroundColor:l,padding:"2px 6px"}},e)}function Q(e){return{50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121"}[e]}function Tt(){return t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-plus",width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},t.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"}))}const i={INITIALIZE_DATA:"initialize_data",CLONE_PREVIOUS_DATA:"CLONE_PREVIOUS_DATA",ADD_OPTION_TO_COLUMN:"add_option_to_column",ADD_ROW:"add_row",DELETE_ROW:"delete_row",UPDATE_COLUMN_TYPE:"update_column_type",UPDATE_COLUMN_HEADER:"update_column_header",UPDATE_CELL:"update_cell",ADD_COLUMN_TO_LEFT:"add_column_to_left",ADD_COLUMN_TO_RIGHT:"add_column_to_right",DELETE_COLUMN:"delete_column",ENABLE_RESET:"enable_reset",DOWNLOAD_TO_SHEET:"download_to_sheet",TOTAL_SUM_CALCULATION:"total_sum_calculation",FILTER_BY_OPTIONS:"filter_by_options"},u={NUMBER:"number",TEXT:"text",SELECT:"select",CALC:"calc"},ee={EXIST_SHEET:"exist_sheet",NEW_SHEET:"new_sheet"},vt="Excel Read & Write",te="No.",z="Count",Le="$",Nt="download",bt="xls",_t=["Column_8"],Lt=[],Rt=[],At="Column 9",pe=["Option 1","Option 2","Option 3","Option 4"],Re=[{type:u.TEXT,name:"Column1",disabled:!1},{type:u.NUMBER,name:"Column2",disabled:!1},{type:u.NUMBER,name:"Column3",disabled:!1},{type:u.CALC,name:"Column4",calc:"{{= Column2 + Column3 }}"},{type:u.NUMBER,name:"Column 5",disabled:!1},{type:u.NUMBER,name:"Column 6",disabled:!1},{type:u.NUMBER,name:"Column 7",disabled:!1},{type:u.CALC,name:"Column 8",calc:"{{= Column2 + Column_7 }}"},{type:u.SELECT,name:"Column 9",options:pe,disabled:!1}];function Ae(e,l=Nt,n=bt){try{ut({data:e,fileName:l,exportType:n})}catch(a){console.error(a)}}const P=(e,l)=>e.findIndex(n=>n.id===l),It=(()=>pe.map((e,l)=>({id:l+1,name:e})))(),Ee=()=>({columns:[],data:[],cloneData:[],selectedFilterValue:[],filterOptions:It,skipReset:!1});function kt(e,l){switch(l.type){case i.FILTER_BY_OPTIONS:{let c=l.filters||[];const o=c.reduce((x,v)=>(x[v.name]=!0,x),{}),f=e.cloneData.length-1,m=e.cloneData.filter((x,v)=>{if(!c.length)return!0;var _=x[At];return!!o[_]||v===f});return N(e,{skipReset:{$set:!0},data:{$apply:()=>ke(e.columns,m)}})}case i.ADD_OPTION_TO_COLUMN:const n=P(e.columns,l.columnId);return N(e,{skipReset:{$set:!0},columns:{[n]:{options:{$push:[{label:l.option,backgroundColor:l.backgroundColor}]}}}});case i.INITIALIZE_DATA:return l.payload.cloneData=l.payload.data,N(e,{$set:l.payload});case i.CLONE_PREVIOUS_DATA:return N(e,{cloneData:{$set:e.data}});case i.ADD_ROW:{let c=e.data.length-1,o=he(e.columns);return N(e,{skipReset:{$set:!0},data:{$splice:[[c,0,o]]}})}case i.DELETE_ROW:return e.cloneData=e.cloneData.filter(c=>c.rowId!==l.rowId),N(e,{skipReset:{$set:!0},data:{$apply:()=>e.data.filter(c=>c.rowId!==l.rowId)}});case i.TOTAL_SUM_CALCULATION:{const c=ye(e.data)(e.columns);let o=e.data.length-1;return N(e,{skipReset:{$set:!0},data:{[o]:{$set:T({},c)}}})}case i.UPDATE_COLUMN_TYPE:{const c=P(e.columns,l.columnId);let o=e.columns[c]||{};switch(l.dataType){case u.NUMBER:return e.columns[c].dataType===u.NUMBER?e:N(e,{skipReset:{$set:!0},columns:{[c]:{dataType:{$set:l.dataType}}},data:{$apply:f=>f.map(m=>b(T({},m),{[o.label]:isNaN(+m[o.label])?"":(+m[o.label]||0).toString()}))}});case u.CALC:return e.columns[c].calc===l.calc?e:N(e,{skipReset:{$set:!0},columns:{[c]:{dataType:{$set:l.dataType}}},data:{$apply:f=>{let m=[...e.columns];return m[c].calc=l.calc,ke(m,f)}}});case u.SELECT:if(e.columns[c].dataType===u.SELECT)return e;{let f=[];return e.data.forEach(m=>{m[l.columnId]&&f.push({label:m[l.columnId],backgroundColor:Mt()})}),N(e,{skipReset:{$set:!0},columns:{[c]:{dataType:{$set:l.dataType},options:{$push:f}}}})}case u.TEXT:return e.columns[c].dataType===u.TEXT?e:e.columns[c].dataType===u.SELECT?N(e,{skipReset:{$set:!0},columns:{[c]:{dataType:{$set:l.dataType}}}}):N(e,{skipReset:{$set:!0},columns:{[c]:{dataType:{$set:l.dataType}}},data:{$apply:f=>f.map(m=>b(T({},m),{[o.label]:m[o.label]+""}))}});default:return e}}case i.UPDATE_COLUMN_HEADER:const a=P(e.columns,l.columnId);return N(e,{skipReset:{$set:!0},columns:{[a]:{label:{$set:l.label},id:{$set:D(l.label)}}}});case i.UPDATE_CELL:{const c=P(e.columns,l.columnId);let o=e.columns[c]||{};if(l.dataType===u.NUMBER&&K(+l.value)){let f=e.data.length-1,m=e.data[l.rowIndex];m[o.label]=l.value;let v=Ce(e.columns)(m,l.rowIndex,e.data);const _=ye(e.data)(e.columns);return N(e,{skipReset:{$set:!0},data:{[l.rowIndex]:{$set:v},[f]:{$set:T({},_)}}})}return N(e,{skipReset:{$set:!0},data:{[l.rowIndex]:{[o.label]:{$set:l.value}}}})}case i.ADD_COLUMN_TO_LEFT:const r=P(e.columns,l.columnId);let s=`Column ${W()}`,h=D(s);return N(e,{skipReset:{$set:!0},columns:{$splice:[[r,0,{id:h,label:s,accessor:s,dataType:u.TEXT,created:l.focus&&!0,options:[]}]]}});case i.ADD_COLUMN_TO_RIGHT:const d=P(e.columns,l.columnId),E=`Column ${W()}`,y=D(E);return N(e,{skipReset:{$set:!0},columns:{$splice:[[d+1,0,{id:y,label:E,accessor:E,dataType:u.TEXT,created:l.focus&&!0,options:[]}]]}});case i.DELETE_COLUMN:const L=P(e.columns,l.columnId);return N(e,{skipReset:{$set:!0},columns:{$splice:[[L,1]]}});case i.ENABLE_RESET:return N(e,{skipReset:{$set:!0}});case i.DOWNLOAD_TO_SHEET:{let c=e.columns.filter(m=>!!m.label),o=[],f=e.data.length-1;return e.data.forEach((m,x)=>{let v={};c.forEach((_,$)=>{let I=m[_.label]||"";_.dataType===u.CALC&&(I=I||0),(_.dataType===u.NUMBER||_.dataType===u.CALC)&&f===x&&$!==0&&(I=(fe(_.label)?'Avg = "':'Sum = "')+Le+(I||0)+'"'),v[_.label]=I}),o.push(v)}),Ae(o),e}default:return e}}const St="header",Ie="cell",Ot=[],wt={evaluate:/\{\{(.+?)\}\}/g,interpolate:/\{\{=(.+?)\}\}/g,escape:/\{\{-(.+?)\}\}/g},Dt=e=>mt(e,wt),fe=e=>_t.findIndex(l=>D(l)===D(e))!==-1,W=()=>"_"+Math.random().toString(36).substring(2,9),Mt=()=>`hsl(${Math.floor(Math.random()*360)}, 95%, 90%)`,D=(e="")=>e.toString().replace(/\s+/g,"_").toLowerCase(),Ut=(e=[])=>e.map(l=>({label:l,backgroundColor:Q(600)})),ke=(e=[],l=[])=>{let n=Ce(e),a=l.map(n),r=ye(a)(e),s=a.length-1;return a[s]=T({},r),a},ye=e=>{let l=it(e);return l=l.slice(0,-1),n=>Se(n)(l)},Pt=(e,l,n)=>+(l[e]||n[e])||0,$t=(e="",l,n,a)=>{let r={};return{expression:e.trim().replace(/([a-zA-Z0-9_]+)/g,h=>{let d=D(h),E=l[d];return E?(Ot.includes(d)?n[E]=Pt(E,n,a):n[E]=+n[E]||0,r[d]=n[E],d):(+d||0).toString()}),result:r}},Ft=(e,l)=>{try{return+Dt(e)(l)||0}catch(n){return console.error(n),0}},Bt=e=>{let l=e.reduce((n,a)=>(n[a.id]=a.label,n),{});return(n,a,r={})=>{try{let s=T({},n),{expression:h,result:d}=$t(a,l,s,r);return Ft(h,d)}catch(s){return console.error(s),0}}},Se=e=>{let l=e[1].label,n={[l]:z};return(a=[])=>{let r=a.length;return a.reduce((s,h,d)=>{for(let[E,y]of Object.entries(h))y=+y,E!==l&&K(+y)&&(s[E]=+s[E]||0,s[E]+=y||0,fe(E)&&d===r-1&&(s[E]=s[E]/r),s[E]=Ne(s[E],3));return s},n)}},Ce=e=>{let l=e.filter(a=>!!a.calc),n=Bt(e);return(a={},r,s=[])=>(l.forEach(h=>{if(h.label){let d=n(a,h.calc,s[0]);a[h.label]=Ne(d,3)}}),a.rowId=a.rowId||W(),a)},Ht=(e,l)=>D(e)===l;function Oe(e,l){return(e===Ie?Rt:Lt).findIndex(r=>Ht(r,l))!==-1}const we=(e,l={})=>{let n=[];return e.forEach(a=>{let r=a.name,s=a.calc||"",h=a.type||(s?u.CALC:K(+l[r])?u.NUMBER:u.TEXT),d=a.options||[];d=Ut(d);let E=D(r),y={id:E,label:r,accessor:r,minwidth:100,isDisabledHeader:a.disabled||Oe(St,E),isDisabledCell:a.disabledCell||Oe(Ie,E),dataType:h,calc:s,options:d};n.push(y)}),n.length&&(n.unshift({id:te,width:20,label:"",disableResizing:!0}),n.push({id:999999,width:20,label:"",disableResizing:!0})),n},jt=e=>{let l=e[0]||{},n=Object.keys(l);return n=n.map(a=>{let r=dt(Re,s=>a===s.name);return r||{name:a}}),we(n,l)};function le(e=[],l=ee.EXIST_SHEET){let n=Ee();if(!e.length&&l===ee.EXIST_SHEET)return n;let a=[];if(ee.EXIST_SHEET===l){a=jt(e);let h=e[e.length-1];Object.values(h).includes(z)&&e.pop()}else{a=De();let h=he(a);e.push(h)}let r=Ce(a);e=e.map(r);let s=Se(a)(e);return e.push(s),n.columns=a,n.data=e,n}const he=(e=[],l={})=>{let a=[...e].reduce((r,s)=>(s.label&&(r[s.label]=l[s.label]||(s.dataType===u.CALC?"0":s.dataType===u.SELECT||s.type===u.SELECT?pe[0]:"")),r),{});return a.rowId=W(),a};function De(){let e=[...Re];return we(e)}function zt(){let e=De();e=e.slice(1,e.length-1);let l=e.reduce((a,r,s)=>(r.dataType===u.NUMBER?a[r.label]=(s+1)*1:a[r.label]="",a),{}),n=[];for(let a=0;a<10;a++){l[e[0].label]=`Item ${a+1}`;let r=he(e,l);n.push(r)}return n=le(n).data,n.forEach(a=>delete a.rowId),n}function Wt({value:e,row:{index:l,original:{rowId:n}},column:{id:a,dataType:r,options:s,isDisabledCell:h},dataDispatch:d,data:E,columns:y}){var G;const L=E.length-1,c=((G=y==null?void 0:y[1])==null?void 0:G.id)||"",[o,f]=p.exports.useState({value:e,update:!1}),[m,x]=p.exports.useState(null),[v,_]=p.exports.useState(null),[$,I]=p.exports.useState(!1),[R,M]=p.exports.useState(!1),[B,ne]=p.exports.useState(null),{styles:ae,attributes:re}=Z(m,v,{placement:"bottom-start",strategy:"fixed"});function X(C){C.key==="Enter"?(C.target.value!==""&&d({type:i.ADD_OPTION_TO_COLUMN,option:C.target.value,columnId:a}),M(!1)):C.key==="Escape"&&M(!1)}function se(C){M(!0)}function A(C){C.target.value!==""&&d({type:i.ADD_OPTION_TO_COLUMN,option:C.target.value,columnId:a}),M(!1)}function V(){let C=s.find(S=>S.label===o.value);return C&&C.backgroundColor||Q(600)}const w=(C,S)=>{let O=C.target.value;S===u.NUMBER&&!K(+O)&&(O=O.replace(/([^0-9.,]+)/g,"")),f({value:O,update:S===u.NUMBER})},H=()=>{d({type:i.DELETE_ROW,rowId:n}),d({type:i.TOTAL_SUM_CALCULATION})};function oe(C){f({value:C.label,update:!0}),I(!1)}p.exports.useEffect(()=>{B&&R&&B.focus()},[B,R]),p.exports.useEffect(()=>{f({value:e,update:!1})},[e]),p.exports.useEffect(()=>{o.update&&(d({type:i.UPDATE_CELL,columnId:a,dataType:r,rowIndex:l,value:o.value}),d({type:i.CLONE_PREVIOUS_DATA}))},[o,d,a,l]);const Y=C=>L===l?C===z?C:"":C.toString(),F=(C,S=!1,O={})=>t.createElement("div",{style:O,className:`data-input h-100 ${r===u.CALC||S?"cell-disabled":""} ${r===u.CALC?"text-align-right":""}`},C);function ce(){if(te===a)return F(l+1,!1,{fontWeight:"400"});if(L===l)return a!==999999&&t.createElement("div",{className:"cell-disabled h-100"},t.createElement("div",{className:"data-input h-100"},u.TEXT!==r&&u.SELECT!==r?t.createElement("div",{className:"d-flex justify-content-between align-items-center"},t.createElement("div",null,fe(a)?"Avg":"Sum"),t.createElement("div",{className:"ms-2 text-ellipsis text-align-right"},Le,o.value||0)):null,c===a&&o.value));if(h)return F(o.value,h);switch(r){case u.CALC:return F(o.value);case u.TEXT:return t.createElement(be,{html:Y((o==null?void 0:o.value)||""),onChange:C=>w(C,r),onBlur:()=>f(C=>({value:C.value,update:!0})),className:"data-input"});case u.NUMBER:return t.createElement(be,{html:o.value&&o.value.toString()||"",onChange:C=>w(C,r),className:"data-input text-align-right"});case u.SELECT:return t.createElement(t.Fragment,null,t.createElement("div",{ref:x,className:"flex-1 cursor-default cell-padding d-flex align-items-center h-100",onClick:()=>I(!0)},o.value&&t.createElement(de,{value:o.value,backgroundColor:V(),className:"text-white cursor-pointer"})),$&&t.createElement("div",{className:"overlay",onClick:()=>I(!1)}),$&&pt.exports.createPortal(t.createElement("div",b(T({className:"bg-white shadow-5 border-radius-md",ref:_},re.popper),{style:b(T({},ae.popper),{zIndex:4,minWidth:200,maxWidth:320,maxHeight:400,padding:"0.75rem",overflow:"auto"})}),t.createElement("div",{className:"d-flex flex-wrap-wrap align-items-center",style:{marginTop:"-0.5rem"}},s.length?s.map((C,S)=>t.createElement("div",{key:S,className:"mt-2 mr-2 cursor-pointer",onClick:()=>oe(C)},t.createElement(de,{value:C.label,backgroundColor:C.backgroundColor||V()}))):!R&&t.createElement("div",{className:"mt-2 text-muted fa-sm me-2"},"No options available!"),R&&t.createElement("div",{className:"mt-2 mr-2 bg-grey-200 border-radius-sm",style:{width:120,padding:"2px 4px"}},t.createElement("input",{type:"text",className:"option-input",onBlur:A,ref:ne,onKeyDown:X})),t.createElement("div",{className:"mt-1 mr-2 cursor-pointer",onClick:se},t.createElement(de,{value:t.createElement("div",{className:"d-flex align-items-center"},t.createElement("span",{className:"svg-icon-sm svg-text"},t.createElement(Tt,null)),t.createElement("span",{className:"text-black fa-sm"},R?"Save":"New")),backgroundColor:Q(200)})))),document.querySelector("#popper-portal")));default:return L!==l?t.createElement("div",{className:"cursor-pointer d-flex align-items-center justify-content-center h-100 hover:text-danger",onClick:H},t.createElement(k,{icon:"trash"})):null}}return ce()}function Xt(){return t.createElement("svg",{width:"48",height:"48",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},t.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t.createElement("line",{x1:"18",y1:"11",x2:"12",y2:"5"}),t.createElement("line",{x1:"6",y1:"11",x2:"12",y2:"5"}))}function Vt(){return t.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},t.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),t.createElement("line",{x1:"18",y1:"13",x2:"12",y2:"19"}),t.createElement("line",{x1:"6",y1:"13",x2:"12",y2:"19"}))}function Yt(){return t.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},t.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),t.createElement("line",{x1:"5",y1:"12",x2:"11",y2:"18"}),t.createElement("line",{x1:"5",y1:"12",x2:"11",y2:"6"}))}function Gt(){return t.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},t.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),t.createElement("line",{x1:"13",y1:"18",x2:"19",y2:"12"}),t.createElement("line",{x1:"13",y1:"6",x2:"19",y2:"12"}))}function Kt(){return t.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},t.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t.createElement("line",{x1:"4",y1:"7",x2:"20",y2:"7"}),t.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),t.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"}),t.createElement("path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"}),t.createElement("path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"}))}function xe(){return t.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},t.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t.createElement("line",{x1:"4",y1:"6",x2:"20",y2:"6"}),t.createElement("line",{x1:"4",y1:"12",x2:"14",y2:"12"}),t.createElement("line",{x1:"4",y1:"18",x2:"18",y2:"18"}))}function Me(){return t.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},t.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t.createElement("rect",{x:"7",y:"3",width:"14",height:"14",rx:"2"}),t.createElement("path",{d:"M17 17v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h2"}))}function Ue(){return t.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},t.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t.createElement("line",{x1:"5",y1:"9",x2:"19",y2:"9"}),t.createElement("line",{x1:"5",y1:"15",x2:"19",y2:"15"}),t.createElement("line",{x1:"11",y1:"4",x2:"7",y2:"20"}),t.createElement("line",{x1:"17",y1:"4",x2:"13",y2:"20"}))}function Zt(e){switch(e){case u.NUMBER:return t.createElement(Ue,null);case u.TEXT:return t.createElement(xe,null);case u.SELECT:return t.createElement(Me,null);case u.CALC:return t.createElement(k,{icon:"calculator",className:"mt-1"});default:return t.createElement(xe,null)}}function qt({column:{id:e,created:l,label:n,dataType:a,isDisabledHeader:r,calc:s,getResizerProps:h,getHeaderProps:d},setSortBy:E,dataDispatch:y}){const[L,c]=p.exports.useState(l||!1),[o,f]=p.exports.useState(null),[m,x]=p.exports.useState(null),[v,_]=p.exports.useState(null),{styles:$,attributes:I}=Z(o,m,{placement:"bottom",strategy:"absolute"}),[R,M]=p.exports.useState(n),[B,ne]=p.exports.useState(null),[ae,re]=p.exports.useState(null),X=Z(B,ae,{placement:"right",strategy:"absolute"}),[se,A]=p.exports.useState(!1),[V,w]=p.exports.useState(!1),[H,oe]=p.exports.useState(null),[Y,F]=p.exports.useState(s||""),[ce,G]=p.exports.useState(null),[C,S]=p.exports.useState(null),O=Z(ce,C,{placement:"right",strategy:"absolute",modifiers:[{name:"offset",options:{offset:[0,0]}}]}),ge=Zt(a),Pe=[{onClick:g=>{y({type:i.UPDATE_COLUMN_HEADER,columnId:e,label:R}),E([{id:e,desc:!1}]),c(!1)},icon:t.createElement(Xt,null),label:"Sort ascending"},{onClick:g=>{y({type:i.UPDATE_COLUMN_HEADER,columnId:e,label:R}),E([{id:e,desc:!0}]),c(!1)},icon:t.createElement(Vt,null),label:"Sort descending"},{onClick:g=>{y({type:i.UPDATE_COLUMN_HEADER,columnId:e,label:R}),y({type:i.ADD_COLUMN_TO_LEFT,columnId:e,focus:!1}),c(!1)},icon:t.createElement(Yt,null),label:"Insert left"},{onClick:g=>{y({type:i.UPDATE_COLUMN_HEADER,columnId:e,label:R}),y({type:i.ADD_COLUMN_TO_RIGHT,columnId:e,focus:!1}),c(!1)},icon:t.createElement(Gt,null),label:"Insert right"},{onClick:g=>{y({type:i.UPDATE_COLUMN_HEADER,columnId:e,label:R}),y({type:i.DELETE_COLUMN,columnId:e}),c(!1)},icon:t.createElement(Kt,null),label:"Delete"}],$e=[{onClick:g=>{y({type:i.UPDATE_COLUMN_TYPE,columnId:e,dataType:u.SELECT}),A(!1),c(!1)},icon:t.createElement(Me,null),label:"Select"},{onClick:g=>{},icon:t.createElement(k,{icon:"calculator",size:"lg"}),label:"Calc"},{onClick:g=>{y({type:i.UPDATE_COLUMN_TYPE,columnId:e,dataType:u.TEXT}),A(!1),c(!1)},icon:t.createElement(xe,null),label:"Text"},{onClick:g=>{y({type:i.UPDATE_COLUMN_TYPE,columnId:e,dataType:u.NUMBER}),A(!1),c(!1)},icon:t.createElement(Ue,null),label:"Number"}],Fe=()=>{y({type:i.UPDATE_COLUMN_TYPE,columnId:e,dataType:u.CALC,calc:Y}),w(!1),A(!1),c(!1)},Be=g=>{g.key==="Enter"&&(y({type:i.UPDATE_COLUMN_HEADER,columnId:e,label:R}),c(!1))},He=g=>{M(g.target.value)},je=g=>{g.preventDefault(),y({type:i.UPDATE_COLUMN_HEADER,columnId:e,label:R})},ze=g=>{g.key==="Enter"&&Fe()},We=g=>{F(g.target.value)},Xe=g=>()=>{g==="Calc"&&w(!0)},Ve=g=>()=>{g==="Calc"&&w(!1)};p.exports.useEffect(()=>{l&&c(!0)},[l]),p.exports.useEffect(()=>{M(n)},[n]),p.exports.useEffect(()=>{F(s)},[s]),p.exports.useEffect(()=>{v&&(v.focus(),v.select())},[v]),p.exports.useEffect(()=>{H&&H.focus()},[H]);function Ye(){return e!==999999&&e!==te?t.createElement(t.Fragment,null,t.createElement("div",b(T({},d()),{className:"th noselect d-inline-block"}),t.createElement("div",{className:`th-content ${r?"cell-disabled":""}`,onClick:()=>!r&&c(!0),ref:f},t.createElement("div",{className:"svg-icon svg-gray icon-margin"},ge),t.createElement("div",{className:"text-ellipsis",title:s?`Formula: ${s}`:""},n)),t.createElement("div",b(T({},h()),{className:"resizer"}))),L&&t.createElement("div",{className:"overlay",onClick:()=>c(!1)}),L&&t.createElement("div",T({ref:x,style:b(T({},$.popper),{zIndex:3})},I.popper),t.createElement("div",{className:"bg-white shadow-5 border-radius-md",style:{width:240}},t.createElement("div",{style:{padding:"0.75rem 0.75rem 0"}},t.createElement("div",{className:"w-100",style:{marginBottom:12}},t.createElement("input",{className:"form-input",ref:_,type:"text",value:R,style:{width:"100%"},onChange:He,onBlur:je,onKeyDown:Be})),t.createElement("span",{className:"font-weight-600 font-size-75 color-grey-500 text-transform-uppercase"},"Property Type")),t.createElement("div",{className:"list-padding"},t.createElement("button",{className:"sort-button",type:"button",onMouseEnter:()=>A(!0),onMouseLeave:()=>A(!1),ref:ne},t.createElement("span",{className:"svg-icon svg-text icon-margin"},ge),t.createElement("span",{className:"text-transform-capitalize"},a)),se&&t.createElement("div",b(T({className:"bg-white shadow-5 border-radius-md list-padding",ref:re,onMouseEnter:()=>A(!0),onMouseLeave:()=>A(!1)},X.attributes.popper),{style:b(T({},X.styles.popper),{width:200,backgroundColor:"white",zIndex:4,top:"5rem"})}),$e.map((g,ue)=>t.createElement("button",{key:ue,className:"sort-button",onClick:g.onClick,ref:G,onMouseEnter:Xe(g.label),onMouseLeave:Ve(g.label)},t.createElement("span",{className:"svg-icon svg-text icon-margin"},g.icon),g.label))),V&&t.createElement("div",b(T({className:"bg-white shadow-5 border-radius-md list-padding",ref:S,onMouseEnter:()=>{A(!0),w(!0)},onMouseLeave:()=>{A(!1),w(!1)}},O.attributes.popper),{style:b(T({},O.styles.popper),{width:200,backgroundColor:"white",zIndex:5})}),t.createElement("div",{className:"px-2 mt-2 mb-3"},t.createElement("label",{className:"mb-1 color-grey-600 font-size-85"},"Calculation:"),t.createElement("input",{className:"form-input",ref:oe,type:"text",value:Y,placeholder:"{{= col1 + col2 }}",style:{width:"100%"},onChange:We,onKeyDown:ze})))),t.createElement("div",{className:"list-padding",key:W(),style:{borderTop:`2px solid ${Q(200)}`}},Pe.map((g,ue)=>t.createElement("button",{key:ue,type:"button",className:"sort-button",onMouseDown:g.onClick},t.createElement("span",{className:"svg-icon svg-text icon-margin"},g.icon),g.label)))))):t.createElement("div",b(T({},d()),{className:"cursor-default th noselect d-inline-block bg-none"}),t.createElement("div",{className:"th-content d-flex justify-content-center"},t.createElement("span",null,te===e?e:"")))}return Ye()}const Jt={minWidth:50,width:150,maxWidth:400,Cell:Wt,Header:qt,sortType:"alphanumericFalsyLast"};function Qt({columns:e,data:l,dispatch:n,skipReset:a}){const r=p.exports.useMemo(()=>({alphanumericFalsyLast(o,f,m,x){return o.values[e[0].id]===z||f.values[e[0].id]===z?x?-1:1:!o.values[m]&&!f.values[m]?0:o.values[m]?f.values[m]?isNaN(o.values[m])?o.values[m].localeCompare(f.values[m]):o.values[m]-f.values[m]:x?1:-1:x?-1:1}}),[]),{getTableProps:s,getTableBodyProps:h,headerGroups:d,rows:E,prepareRow:y,totalColumnsWidth:L}=q.exports.useTable({columns:e,data:l,defaultColumn:Jt,dataDispatch:n,autoResetSortBy:!a,autoResetFilters:!a,autoResetRowState:!a,sortTypes:r},q.exports.useBlockLayout,q.exports.useResizeColumns,q.exports.useSortBy);function c(){for(let o of d)for(let f of o.headers)if(f.isResizing)return!0;return!1}return t.createElement("div",{className:"overflow-y-hidden",style:{width:"auto",height:"100%"}},t.createElement("div",b(T({},s()),{className:Et("custom-table table-sticky",c()&&"noselect")}),d.map((o,f)=>t.createElement("div",b(T({},o.getHeaderGroupProps()),{className:"tr",key:f}),o.headers.map((m,x)=>t.createElement("div",{key:x,className:"table-head"},m.render("Header"))))),t.createElement("div",T({},h()),E.map((o,f)=>(y(o),t.createElement("div",b(T({key:f},o.getRowProps()),{className:"tr"}),o.cells.map(m=>t.createElement("div",b(T({},m.getCellProps()),{className:"td"}),m.render("Cell")))))))),t.createElement("div",{id:"popper-portal"}))}const el={flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#9b9b9b",outline:"none",transition:"border .24s ease-in-out",minHeight:"250px"},tl={borderColor:"#2196f3"},ll={borderColor:"#00e676"},nl={borderColor:"#ff1744"};function al({uploadFile:e}){const[l,n]=p.exports.useState(!1),a=p.exports.useCallback(c=>{n(!0),e(c[0])},[]),r=p.exports.useCallback(c=>{n(!1),ie.error("Only support *.xlsx, *.xls and *.csv files")}),{getRootProps:s,getInputProps:h,isDragActive:d,isDragAccept:E,isDragReject:y}=ft({onDrop:a,onDropRejected:r,maxFiles:1,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,text/csv"}),L=p.exports.useMemo(()=>T(T(T(T({},el),d?tl:{}),E?ll:{}),y?nl:{}),[d,y,E]);return t.createElement(t.Fragment,null,t.createElement("div",b(T({},s({style:L})),{className:"cursor-pointer"}),l?t.createElement("div",{className:"d-flex justify-content-center align-items-center"},t.createElement(yt,{animation:"border",role:"status"},t.createElement("span",{className:"visually-hidden"},"Loading...")),t.createElement("div",{className:"ms-2"},"Loading...")):t.createElement(t.Fragment,null,t.createElement("input",T({},h())),d?t.createElement("p",null,"Drop the files here ..."):t.createElement(t.Fragment,null,t.createElement("p",null,"Drag 'n' drop some files here, or click to select excel files"),t.createElement("em",null,"(Only *.xlsx, *.xls and *.csv files will be accepted)")))),t.createElement(_e,null))}async function rl(e){if(!(e instanceof File))throw new Error("Please upload a valid *.xlsx, *.xls and *.csv files!");let l=e.type;if(!l||!l.includes("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")&&!l.includes("application/vnd.ms-excel"))throw new Error("Please upload a valid *.xlsx, *.xls and *.csv files!");const n=await Ct.onFileSelection(e);let a=Object.keys(n)[0];return n[a]}const sl=()=>{const[e,l]=p.exports.useReducer(kt,Ee()),[n,a]=p.exports.useState(!0),r=p.exports.useRef(null);p.exports.useEffect(()=>{l({type:i.ENABLE_RESET})},[e.data,e.columns]);const s=()=>{l({type:i.ADD_COLUMN_TO_LEFT,columnId:999999,focus:!0})},h=()=>{l({type:i.ADD_ROW}),l({type:i.CLONE_PREVIOUS_DATA})},d=()=>{var x;(x=r.current)==null||x.click()},E=()=>{l({type:i.DOWNLOAD_TO_SHEET})},y=()=>{const x=zt();Ae(x)},L=()=>{var x,v;return c((v=(x=r.current)==null?void 0:x.files)==null?void 0:v[0])},c=p.exports.useCallback(async x=>{if(!!x)try{const v=await rl(x);let _=le(v);a(!1),l({type:i.INITIALIZE_DATA,payload:_}),ie.success("Successfully Parsed.")}catch(v){console.error(v),ie.error("Please upload a valid xlsx file with data!"),l({type:i.INITIALIZE_DATA,payload:le([])})}},[]),o=()=>{let x=le([],ee.NEW_SHEET);a(!0),l({type:i.INITIALIZE_DATA,payload:x})},f=x=>{l({type:i.FILTER_BY_OPTIONS,filters:x}),l({type:i.TOTAL_SUM_CALCULATION})},m=()=>{l({type:i.INITIALIZE_DATA,payload:Ee()})};return t.createElement(t.Fragment,null,t.createElement(me,{fluid:!0},t.createElement(J,{className:"pt-4 my-4"},t.createElement("h1",{className:"d-flex justify-content-center align-items-center"},t.createElement(k,{icon:"file-excel",className:"mr-2"}),vt)),e.data.length?t.createElement(me,{fluid:!0},t.createElement(J,null,t.createElement("div",{className:"flex-wrap mb-2 d-flex justify-content-between align-items-center min-height-3rem"},t.createElement("div",null,t.createElement("input",{ref:r,className:"d-none",id:"uploadFile",name:"uploadFile",onChange:L,type:"file",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,text/csv"}),t.createElement(U,{variant:"success",className:"mb-2 mr-4",onClick:d},t.createElement(k,{icon:"upload",className:"mr-2"}),"Upload XLSX"),t.createElement(U,{variant:"primary",className:"mb-2 mr-4",onClick:E},t.createElement(k,{icon:"download",className:"mr-2"}),"Download XLSX"),t.createElement(U,{variant:"outline-success",className:"mb-2 mr-4",onClick:h},t.createElement(k,{icon:"plus",className:"mr-2"}),"Add Row"),t.createElement(U,{variant:"outline-primary",className:"mb-2 mr-4",onClick:s},t.createElement(k,{icon:"plus",className:"mr-2"}),"Add Column")),t.createElement("div",{className:"d-inline-block"},t.createElement("div",{className:"d-flex align-items-center"},n&&t.createElement("div",{className:"mr-4 d-flex"},t.createElement(ht.exports.Multiselect,{options:e.filterOptions,selectedValues:e.selectedFilterValue,avoidHighlightFirstOption:!0,placeholder:"Filters",onSelect:f,onRemove:f,displayValue:"name"})),t.createElement(U,{variant:"light",onClick:m},t.createElement(k,{icon:"redo",className:"mr-2"}),"RESET"))))),t.createElement(J,{style:{overflow:"auto",display:"flex"}},t.createElement(j,{style:{flex:"1 1 auto",padding:"1rem"}},t.createElement(Qt,{columns:e.columns,data:e.data,dispatch:l,skipReset:e.skipReset})))):t.createElement(me,null,t.createElement(J,{className:"mb-2 d-flex flex-column justify-content-center"},t.createElement(j,{className:"mb-2 text-align-right"},t.createElement(U,{variant:"primary",onClick:y},t.createElement(k,{icon:"download",className:"mr-2"}),"Download Sample XLSX")),t.createElement(j,null,t.createElement(al,{uploadFile:c})),t.createElement(j,{className:"my-5 text-center text-black-50 font-weight-600 font-size-120"},t.createElement("div",{className:"border-line"},"OR")),t.createElement(j,{className:"mb-4 text-center"},t.createElement(U,{variant:"success",onClick:o},t.createElement(k,{icon:"plus",className:"mr-2"}),"Create a New Sheet"))))),t.createElement(_e,null))};xt.render(t.createElement(t.StrictMode,null,t.createElement(sl,null)),document.getElementById("root"));
