var Xe=Object.defineProperty,Ye=Object.defineProperties;var Ve=Object.getOwnPropertyDescriptors;var Te=Object.getOwnPropertySymbols;var Ge=Object.prototype.hasOwnProperty,Ke=Object.prototype.propertyIsEnumerable;var ge=(t,l,n)=>l in t?Xe(t,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[l]=n,T=(t,l)=>{for(var n in l||(l={}))Ge.call(l,n)&&ge(t,n,l[n]);if(Te)for(var n of Te(l))Ke.call(l,n)&&ge(t,n,l[n]);return t},b=(t,l)=>Ye(t,Ve(l));import{l as Ze,f as qe,a as Je,b as Qe,c as et,d as tt,e as lt,g as nt,h as at,i as rt,R as e,j as st,u as _,k as V,r as Ne,m as ot,t as ct,n as E,o as G,F as O,p as ut,_ as _e,q as K,s as it,v as ue,w as mt,S as dt,T as be,x as pt,C as ie,y as Z,B as F,z as Et,A as q,D as ft}from"./vendor.e2182046.js";const yt=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const f of s.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};yt();Ze.add(qe,Je,Qe,et,tt,lt,nt,at,rt);function me({value:t,backgroundColor:l,className:n="text-white"}){return e.createElement("span",{className:`font-weight-400 d-inline-block color-grey-800 border-radius-sm fa-sm text-transform-capitalize ${n}`,style:{backgroundColor:l,padding:"2px 6px"}},t)}function J(t){return{50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121"}[t]}function Ct(){return e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-plus",width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"}))}const m={INITIALIZE_DATA:"initialize_data",CLONE_PREVIOUS_DATA:"CLONE_PREVIOUS_DATA",ADD_OPTION_TO_COLUMN:"add_option_to_column",ADD_ROW:"add_row",DELETE_ROW:"delete_row",UPDATE_COLUMN_TYPE:"update_column_type",UPDATE_COLUMN_HEADER:"update_column_header",UPDATE_CELL:"update_cell",ADD_COLUMN_TO_LEFT:"add_column_to_left",ADD_COLUMN_TO_RIGHT:"add_column_to_right",DELETE_COLUMN:"delete_column",ENABLE_RESET:"enable_reset",DOWNLOAD_TO_SHEET:"download_to_sheet",TOTAL_SUM_CALCULATION:"total_sum_calculation",FILTER_BY_OPTIONS:"filter_by_options"},i={NUMBER:"number",TEXT:"text",SELECT:"select",CALC:"calc"},Q={EXIST_SHEET:"exist_sheet",NEW_SHEET:"new_sheet"},ht="Excel Read & Write",ee="No.",xt=20,te="Count",ve="$",Tt="download",gt="xls",Nt=[],_t=[],bt=[],vt="Column 9",de=["Option 1","Option 2","Option 3","Option 4"],Lt=[{type:i.TEXT,name:"Column1",disabled:!1},{type:i.NUMBER,name:"Column2",disabled:!1},{type:i.NUMBER,name:"Column3",disabled:!1},{type:i.CALC,name:"Column4",calc:"{{= Column2 + Column3 }}",disabled:!1},{type:i.NUMBER,name:"Column 5",disabled:!1},{type:i.TEXT,name:"Column 6",disabled:!1},{type:i.NUMBER,name:"Column 7",disabled:!1},{type:i.CALC,name:"Column 8",calc:"{{= Column2 * Column_7 }}",disabled:!1},{type:i.SELECT,name:"Column 9",options:de,disabled:!1}];function At(t,l=Tt,n=gt){try{st({data:t,fileName:l,exportType:n})}catch(a){console.error(a)}}const P=(t,l)=>t.findIndex(n=>n.id===l),It=(()=>de.map((t,l)=>({id:l+1,name:t})))(),pe=()=>({columns:[],data:[],cloneData:[],selectedFilterValue:[],filterOptions:It,skipReset:!1});function Rt(t,l){switch(l.type){case m.FILTER_BY_OPTIONS:{let c=l.filters||[];const o=c.reduce((g,v)=>(g[v.name]=!0,g),{}),d=t.cloneData.length-1,u=t.cloneData.filter((g,v)=>{if(!c.length)return!0;var A=g[vt];return!!o[A]||v===d});return _(t,{skipReset:{$set:!0},data:{$apply:()=>Ae(t.columns,u)}})}case m.ADD_OPTION_TO_COLUMN:const n=P(t.columns,l.columnId);return _(t,{skipReset:{$set:!0},columns:{[n]:{options:{$push:[{label:l.option,backgroundColor:l.backgroundColor}]}}}});case m.INITIALIZE_DATA:return l.payload.cloneData=l.payload.data,_(t,{$set:l.payload});case m.CLONE_PREVIOUS_DATA:return _(t,{cloneData:{$set:t.data}});case m.ADD_ROW:{let c=t.data.length-1,o=Oe(t.columns);return _(t,{skipReset:{$set:!0},data:{$splice:[[c,0,o]]}})}case m.DELETE_ROW:return t.cloneData=t.cloneData.filter(c=>c.rowId!==l.rowId),_(t,{skipReset:{$set:!0},data:{$apply:()=>t.data.filter(c=>c.rowId!==l.rowId)}});case m.TOTAL_SUM_CALCULATION:{const c=fe(t.data)(t.columns);let o=t.data.length-1;return _(t,{skipReset:{$set:!0},data:{[o]:{$set:T({},c)}}})}case m.UPDATE_COLUMN_TYPE:{const c=P(t.columns,l.columnId);let o=t.columns[c]||{};switch(l.dataType){case i.NUMBER:return t.columns[c].dataType===i.NUMBER?t:_(t,{skipReset:{$set:!0},columns:{[c]:{dataType:{$set:l.dataType}}},data:{$apply:d=>d.map(u=>b(T({},u),{[o.label]:isNaN(+u[o.label])?"":(+u[o.label]||0).toString()}))}});case i.CALC:return t.columns[c].calc===l.calc?t:_(t,{skipReset:{$set:!0},columns:{[c]:{dataType:{$set:l.dataType}}},data:{$apply:d=>{let u=[...t.columns];return u[c].calc=l.calc,Ae(u,d)}}});case i.SELECT:if(t.columns[c].dataType===i.SELECT)return t;{let d=[];return t.data.forEach(u=>{u[l.columnId]&&d.push({label:u[l.columnId],backgroundColor:St()})}),_(t,{skipReset:{$set:!0},columns:{[c]:{dataType:{$set:l.dataType},options:{$push:d}}}})}case i.TEXT:return t.columns[c].dataType===i.TEXT?t:t.columns[c].dataType===i.SELECT?_(t,{skipReset:{$set:!0},columns:{[c]:{dataType:{$set:l.dataType}}}}):_(t,{skipReset:{$set:!0},columns:{[c]:{dataType:{$set:l.dataType}}},data:{$apply:d=>d.map(u=>b(T({},u),{[o.label]:u[o.label]+""}))}});default:return t}}case m.UPDATE_COLUMN_HEADER:const a=P(t.columns,l.columnId);return _(t,{skipReset:{$set:!0},columns:{[a]:{label:{$set:l.label},id:{$set:D(l.label)}}}});case m.UPDATE_CELL:{const c=P(t.columns,l.columnId);let o=t.columns[c]||{};if(l.dataType===i.NUMBER&&V(+l.value)){let d=t.data.length-1,u=t.data[l.rowIndex];u[o.label]=l.value;let v=ye(t.columns)(u,l.rowIndex,t.data);const A=fe(t.data)(t.columns);return _(t,{skipReset:{$set:!0},data:{[l.rowIndex]:{$set:v},[d]:{$set:T({},A)}}})}return _(t,{skipReset:{$set:!0},data:{[l.rowIndex]:{[o.label]:{$set:l.value}}}})}case m.ADD_COLUMN_TO_LEFT:const r=P(t.columns,l.columnId);let s=`Column ${j()}`,f=D(s);return _(t,{skipReset:{$set:!0},columns:{$splice:[[r,0,{id:f,label:s,accessor:s,dataType:i.TEXT,created:l.focus&&!0,options:[]}]]}});case m.ADD_COLUMN_TO_RIGHT:const p=P(t.columns,l.columnId),x=`Column ${j()}`,y=D(x);return _(t,{skipReset:{$set:!0},columns:{$splice:[[p+1,0,{id:y,label:x,accessor:x,dataType:i.TEXT,created:l.focus&&!0,options:[]}]]}});case m.DELETE_COLUMN:const L=P(t.columns,l.columnId);return _(t,{skipReset:{$set:!0},columns:{$splice:[[L,1]]}});case m.ENABLE_RESET:return _(t,{skipReset:{$set:!0}});case m.DOWNLOAD_TO_SHEET:{let c=t.columns.filter(g=>!!g.label),d=[[...c.map(g=>g.label)]],u=t.data.length-1;return t.data.forEach((g,v)=>{let A=v+1;d[A]=d[A]||[],c.forEach((I,M)=>{let N=g[I.label]||"";I.dataType===i.CALC&&(N=N||0),(I.dataType===i.NUMBER||I.dataType===i.CALC)&&u===v&&M!==0&&(N=(Ee(I.label)?'Avg = "':'Sum = "')+ve+(N||0)+'"'),d[A].push(N)})}),At(d),t}default:return t}}const kt="header",Le="cell",Ot=[],Ee=t=>Nt.findIndex(l=>D(l)===D(t))!==-1,j=()=>"_"+Math.random().toString(36).substr(2,9),St=()=>`hsl(${Math.floor(Math.random()*360)}, 95%, 90%)`,D=(t="")=>t.toString().replace(/\s+/g,"_").toLowerCase(),wt=(t=[])=>t.map(l=>({label:l,backgroundColor:J(600)})),Ae=(t=[],l=[])=>{let n=ye(t),a=l.map(n),r=fe(a)(t),s=a.length-1;return a[s]=T({},r),a},fe=t=>(t=ot(t),l=>Ie(l)(t.slice(0,-1))),Dt=(t,l,n)=>+(l[t]||n[t])||0,Mt=(t="",l,n,a)=>{let r={};return{expression:t.trim().replace(/([a-zA-Z0-9_]+)/g,f=>{f=D(f);let p=l[f]||f;return p&&(Ot.includes(f)?n[p]=Dt(p,record,a):n[p]=+n[p]||0,r[f]=n[p],f)}),result:r}},Ut=t=>{try{let l=ct(t);return n=>{try{return+l(n)}catch(a){return console.error(a),0}}}catch(l){return console.error(l),()=>0}},Pt=t=>{let l=t.reduce((n,a)=>(n[a.id]=a.label,n),{});return(n,a,r={})=>{try{let s=T({},n),{expression:f,result:p}=Mt(a,l,s,r);return Ut(f)(p)||0}catch(s){return console.error(s),0}}},Ie=t=>{let l=t[1].label,n={[l]:te};return(a=[])=>{let r=a.length;return a.reduce((s,f,p)=>{for(let[x,y]of Object.entries(f))y=+y,x!==l&&V(y)&&(s[x]=+s[x]||0,s[x]+=y||0,Ee(x)&&p===r-1&&(s[x]=s[x]/r),s[x]=Ne(s[x],3));return s},n)}},ye=t=>{let l=t.filter(a=>!!a.calc),n=Pt(t);return(a={},r,s=[])=>(l.forEach(f=>{if(f.label){let p=n(a,f.calc,s[0]);a[f.label]=Ne(p,3)}}),a.rowId=a.rowId||j(),a)},$t=(t,l)=>D(t)===l;function Re(t,l){return(t===Le?bt:_t).findIndex(r=>$t(r,l))!==-1}const ke=(t,l={})=>{let n=[];return t.forEach(a=>{let r=a.name,s=D(r),f=a.calc||"",p=a.type||(f?i.CALC:V(+l[r])?i.NUMBER:i.TEXT),x=a.options||[];x=wt(x);let y={id:s,label:r,accessor:r,minwidth:100,isDisabledHeader:a.disabled||Re(kt,s),isDisabledCell:a.disabledCell||Re(Le,s),dataType:p,calc:f,options:x};n.push(y)}),n.length&&(n.unshift({id:ee,width:xt,label:"",disableResizing:!0}),n.push({id:999999,width:20,label:"",disableResizing:!0})),n},Ft=t=>{let l=t[0]||{},n=Object.keys(l);return n=n.map(a=>({name:a})),ke(n,l)};function Ce(t=[],l=Q.EXIST_SHEET){let n=pe();if(!t.length&&l===Q.EXIST_SHEET)return n;let a=l===Q.EXIST_SHEET?Ft(t):Ht(t),r=ye(a);t=t.map(r);let s=Ie(a)(t);return t.push(s),n.columns=a,n.data=t,n}const Oe=(t=[])=>{let n=[...t].reduce((a,r)=>(r.label&&(a[r.label]=r.dataType===i.CALC?"0":r.dataType===i.SELECT||r.type===i.SELECT?de[0]:""),a),{});return n.rowId=j(),n};function Ht(t){let l=[...Lt];return l=ke(l),t.push(Oe(l)),l}function Bt({value:t,row:{index:l,original:{rowId:n}},column:{id:a,dataType:r,options:s,isDisabledCell:f},dataDispatch:p,data:x,columns:y}){var Y;const L=x.length-1,c=((Y=y==null?void 0:y[1])==null?void 0:Y.id)||"",[o,d]=E.exports.useState({value:t,update:!1}),[u,g]=E.exports.useState(null),[v,A]=E.exports.useState(null),[I,M]=E.exports.useState(!1),[N,U]=E.exports.useState(!1),[H,le]=E.exports.useState(null),{styles:ne,attributes:ae}=G(u,v,{placement:"bottom-start",strategy:"fixed"});function z(C){C.key==="Enter"?(C.target.value!==""&&p({type:m.ADD_OPTION_TO_COLUMN,option:C.target.value,columnId:a}),U(!1)):C.key==="Escape"&&U(!1)}function re(C){U(!0)}function R(C){C.target.value!==""&&p({type:m.ADD_OPTION_TO_COLUMN,option:C.target.value,columnId:a}),U(!1)}function W(){let C=s.find(k=>k.label===o.value);return C&&C.backgroundColor||J(600)}const w=(C,k)=>{let S=C.target.value;k===i.NUMBER&&!V(+S)&&(S=S.replace(/([^0-9.,]+)/g,"")),d({value:S,update:k===i.NUMBER})},B=()=>{p({type:m.DELETE_ROW,rowId:n}),p({type:m.TOTAL_SUM_CALCULATION})};function se(C){d({value:C.label,update:!0}),M(!1)}E.exports.useEffect(()=>{H&&N&&H.focus()},[H,N]),E.exports.useEffect(()=>{d({value:t,update:!1})},[t]),E.exports.useEffect(()=>{o.update&&(p({type:m.UPDATE_CELL,columnId:a,dataType:r,rowIndex:l,value:o.value}),p({type:m.CLONE_PREVIOUS_DATA}))},[o,p,a,l]);const X=C=>L===l?C===te?C:"":C.toString(),$=(C,k=!1,S={})=>e.createElement("div",{style:S,className:`data-input h-100 ${r===i.CALC||k?"cell-disabled":""} ${r===i.CALC?"text-align-right":""}`},C);function oe(){if(ee===a)return $(l+1,!1,{fontWeight:"400"});if(L===l)return a!==999999&&e.createElement("div",{className:"cell-disabled h-100"},e.createElement("div",{className:"data-input h-100"},i.TEXT!==r&&i.SELECT!==r?e.createElement("div",{className:"d-flex justify-content-between align-items-center"},e.createElement("div",null,Ee(a)?"Avg":"Sum"),e.createElement("div",{className:"ms-2 text-ellipsis text-align-right"},ve,o.value||0)):null,c===a&&o.value));if(f)return $(o.value,f);switch(r){case i.CALC:return $(o.value);case i.TEXT:return e.createElement(_e,{html:X((o==null?void 0:o.value)||""),onChange:C=>w(C,r),onBlur:()=>d(C=>({value:C.value,update:!0})),className:"data-input"});case i.NUMBER:return e.createElement(_e,{html:o.value&&o.value.toString()||"",onChange:C=>w(C,r),className:"data-input text-align-right"});case i.SELECT:return e.createElement(e.Fragment,null,e.createElement("div",{ref:g,className:"flex-1 cursor-default cell-padding d-flex align-items-center h-100",onClick:()=>M(!0)},o.value&&e.createElement(me,{value:o.value,backgroundColor:W(),className:"text-white cursor-pointer"})),I&&e.createElement("div",{className:"overlay",onClick:()=>M(!1)}),I&&ut.exports.createPortal(e.createElement("div",b(T({className:"bg-white shadow-5 border-radius-md",ref:A},ae.popper),{style:b(T({},ne.popper),{zIndex:4,minWidth:200,maxWidth:320,maxHeight:400,padding:"0.75rem",overflow:"auto"})}),e.createElement("div",{className:"d-flex flex-wrap-wrap align-items-center",style:{marginTop:"-0.5rem"}},s.length?s.map((C,k)=>e.createElement("div",{key:k,className:"mt-2 mr-2 cursor-pointer",onClick:()=>se(C)},e.createElement(me,{value:C.label,backgroundColor:C.backgroundColor||W()}))):!N&&e.createElement("div",{className:"mt-2 text-muted fa-sm me-2"},"No options available!"),N&&e.createElement("div",{className:"mt-2 mr-2 bg-grey-200 border-radius-sm",style:{width:120,padding:"2px 4px"}},e.createElement("input",{type:"text",className:"option-input",onBlur:R,ref:le,onKeyDown:z})),e.createElement("div",{className:"mt-1 mr-2 cursor-pointer",onClick:re},e.createElement(me,{value:e.createElement("div",{className:"d-flex align-items-center"},e.createElement("span",{className:"svg-icon-sm svg-text"},e.createElement(Ct,null)),e.createElement("span",{className:"text-black fa-sm"},N?"Save":"New")),backgroundColor:J(200)})))),document.querySelector("#popper-portal")));default:return L!==l?e.createElement("div",{className:"cursor-pointer d-flex align-items-center justify-content-center h-100 hover:text-danger",onClick:B},e.createElement(O,{icon:"trash"})):null}}return oe()}function jt(){return e.createElement("svg",{width:"48",height:"48",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e.createElement("line",{x1:"18",y1:"11",x2:"12",y2:"5"}),e.createElement("line",{x1:"6",y1:"11",x2:"12",y2:"5"}))}function zt(){return e.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e.createElement("line",{x1:"18",y1:"13",x2:"12",y2:"19"}),e.createElement("line",{x1:"6",y1:"13",x2:"12",y2:"19"}))}function Wt(){return e.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),e.createElement("line",{x1:"5",y1:"12",x2:"11",y2:"18"}),e.createElement("line",{x1:"5",y1:"12",x2:"11",y2:"6"}))}function Xt(){return e.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),e.createElement("line",{x1:"13",y1:"18",x2:"19",y2:"12"}),e.createElement("line",{x1:"13",y1:"6",x2:"19",y2:"12"}))}function Yt(){return e.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.createElement("line",{x1:"4",y1:"7",x2:"20",y2:"7"}),e.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),e.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"}),e.createElement("path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"}),e.createElement("path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"}))}function he(){return e.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.createElement("line",{x1:"4",y1:"6",x2:"20",y2:"6"}),e.createElement("line",{x1:"4",y1:"12",x2:"14",y2:"12"}),e.createElement("line",{x1:"4",y1:"18",x2:"18",y2:"18"}))}function Se(){return e.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.createElement("rect",{x:"7",y:"3",width:"14",height:"14",rx:"2"}),e.createElement("path",{d:"M17 17v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h2"}))}function we(){return e.createElement("svg",{width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#2c3e50",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.createElement("line",{x1:"5",y1:"9",x2:"19",y2:"9"}),e.createElement("line",{x1:"5",y1:"15",x2:"19",y2:"15"}),e.createElement("line",{x1:"11",y1:"4",x2:"7",y2:"20"}),e.createElement("line",{x1:"17",y1:"4",x2:"13",y2:"20"}))}function Vt(t){switch(t){case i.NUMBER:return e.createElement(we,null);case i.TEXT:return e.createElement(he,null);case i.SELECT:return e.createElement(Se,null);case i.CALC:return e.createElement(O,{icon:"calculator",className:"mt-1"});default:return e.createElement(he,null)}}function Gt({column:{id:t,created:l,label:n,dataType:a,isDisabledHeader:r,calc:s,getResizerProps:f,getHeaderProps:p},setSortBy:x,dataDispatch:y}){const[L,c]=E.exports.useState(l||!1),[o,d]=E.exports.useState(null),[u,g]=E.exports.useState(null),[v,A]=E.exports.useState(null),{styles:I,attributes:M}=G(o,u,{placement:"bottom",strategy:"absolute"}),[N,U]=E.exports.useState(n),[H,le]=E.exports.useState(null),[ne,ae]=E.exports.useState(null),z=G(H,ne,{placement:"right",strategy:"absolute"}),[re,R]=E.exports.useState(!1),[W,w]=E.exports.useState(!1),[B,se]=E.exports.useState(null),[X,$]=E.exports.useState(s||""),[oe,Y]=E.exports.useState(null),[C,k]=E.exports.useState(null),S=G(oe,C,{placement:"right",strategy:"absolute",modifiers:[{name:"offset",options:{offset:[0,0]}}]}),xe=Vt(a),De=[{onClick:h=>{y({type:m.UPDATE_COLUMN_HEADER,columnId:t,label:N}),x([{id:t,desc:!1}]),c(!1)},icon:e.createElement(jt,null),label:"Sort ascending"},{onClick:h=>{y({type:m.UPDATE_COLUMN_HEADER,columnId:t,label:N}),x([{id:t,desc:!0}]),c(!1)},icon:e.createElement(zt,null),label:"Sort descending"},{onClick:h=>{y({type:m.UPDATE_COLUMN_HEADER,columnId:t,label:N}),y({type:m.ADD_COLUMN_TO_LEFT,columnId:t,focus:!1}),c(!1)},icon:e.createElement(Wt,null),label:"Insert left"},{onClick:h=>{y({type:m.UPDATE_COLUMN_HEADER,columnId:t,label:N}),y({type:m.ADD_COLUMN_TO_RIGHT,columnId:t,focus:!1}),c(!1)},icon:e.createElement(Xt,null),label:"Insert right"},{onClick:h=>{y({type:m.UPDATE_COLUMN_HEADER,columnId:t,label:N}),y({type:m.DELETE_COLUMN,columnId:t}),c(!1)},icon:e.createElement(Yt,null),label:"Delete"}],Me=[{onClick:h=>{y({type:m.UPDATE_COLUMN_TYPE,columnId:t,dataType:i.SELECT}),R(!1),c(!1)},icon:e.createElement(Se,null),label:"Select"},{onClick:h=>{},icon:e.createElement(O,{icon:"calculator",size:"lg"}),label:"Calc"},{onClick:h=>{y({type:m.UPDATE_COLUMN_TYPE,columnId:t,dataType:i.TEXT}),R(!1),c(!1)},icon:e.createElement(he,null),label:"Text"},{onClick:h=>{y({type:m.UPDATE_COLUMN_TYPE,columnId:t,dataType:i.NUMBER}),R(!1),c(!1)},icon:e.createElement(we,null),label:"Number"}],Ue=()=>{y({type:m.UPDATE_COLUMN_TYPE,columnId:t,dataType:i.CALC,calc:X}),w(!1),R(!1),c(!1)},Pe=h=>{h.key==="Enter"&&(y({type:m.UPDATE_COLUMN_HEADER,columnId:t,label:N}),c(!1))},$e=h=>{U(h.target.value)},Fe=h=>{h.preventDefault(),y({type:m.UPDATE_COLUMN_HEADER,columnId:t,label:N})},He=h=>{h.key==="Enter"&&Ue()},Be=h=>{$(h.target.value)},je=h=>()=>{h==="Calc"&&w(!0)},ze=h=>()=>{h==="Calc"&&w(!1)};E.exports.useEffect(()=>{l&&c(!0)},[l]),E.exports.useEffect(()=>{U(n)},[n]),E.exports.useEffect(()=>{$(s)},[s]),E.exports.useEffect(()=>{v&&(v.focus(),v.select())},[v]),E.exports.useEffect(()=>{B&&B.focus()},[B]);function We(){return t!==999999&&t!==ee?e.createElement(e.Fragment,null,e.createElement("div",b(T({},p()),{className:"th noselect d-inline-block"}),e.createElement("div",{className:`th-content ${r?"cell-disabled":""}`,onClick:()=>!r&&c(!0),ref:d},e.createElement("div",{className:"svg-icon svg-gray icon-margin"},xe),e.createElement("div",{className:"text-ellipsis",title:s?`Formula: ${s}`:""},n)),e.createElement("div",b(T({},f()),{className:"resizer"}))),L&&e.createElement("div",{className:"overlay",onClick:()=>c(!1)}),L&&e.createElement("div",T({ref:g,style:b(T({},I.popper),{zIndex:3})},M.popper),e.createElement("div",{className:"bg-white shadow-5 border-radius-md",style:{width:240}},e.createElement("div",{style:{padding:"0.75rem 0.75rem 0"}},e.createElement("div",{className:"w-100",style:{marginBottom:12}},e.createElement("input",{className:"form-input",ref:A,type:"text",value:N,style:{width:"100%"},onChange:$e,onBlur:Fe,onKeyDown:Pe})),e.createElement("span",{className:"font-weight-600 font-size-75 color-grey-500 text-transform-uppercase"},"Property Type")),e.createElement("div",{className:"list-padding"},e.createElement("button",{className:"sort-button",type:"button",onMouseEnter:()=>R(!0),onMouseLeave:()=>R(!1),ref:le},e.createElement("span",{className:"svg-icon svg-text icon-margin"},xe),e.createElement("span",{className:"text-transform-capitalize"},a)),re&&e.createElement("div",b(T({className:"bg-white shadow-5 border-radius-md list-padding",ref:ae,onMouseEnter:()=>R(!0),onMouseLeave:()=>R(!1)},z.attributes.popper),{style:b(T({},z.styles.popper),{width:200,backgroundColor:"white",zIndex:4,top:"5rem"})}),Me.map((h,ce)=>e.createElement("button",{key:ce,className:"sort-button",onClick:h.onClick,ref:Y,onMouseEnter:je(h.label),onMouseLeave:ze(h.label)},e.createElement("span",{className:"svg-icon svg-text icon-margin"},h.icon),h.label))),W&&e.createElement("div",b(T({className:"bg-white shadow-5 border-radius-md list-padding",ref:k,onMouseEnter:()=>{R(!0),w(!0)},onMouseLeave:()=>{R(!1),w(!1)}},S.attributes.popper),{style:b(T({},S.styles.popper),{width:200,backgroundColor:"white",zIndex:5})}),e.createElement("div",{className:"px-2 mt-2 mb-3"},e.createElement("label",{className:"mb-1 color-grey-600 font-size-85"},"Calculation:"),e.createElement("input",{className:"form-input",ref:se,type:"text",value:X,placeholder:"{{= col1 + col2 }}",style:{width:"100%"},onChange:Be,onKeyDown:He})))),e.createElement("div",{className:"list-padding",key:j(),style:{borderTop:`2px solid ${J(200)}`}},De.map((h,ce)=>e.createElement("button",{key:ce,type:"button",className:"sort-button",onMouseDown:h.onClick},e.createElement("span",{className:"svg-icon svg-text icon-margin"},h.icon),h.label)))))):e.createElement("div",b(T({},p()),{className:"cursor-default th noselect d-inline-block bg-none"}),e.createElement("div",{className:"th-content d-flex justify-content-center"},e.createElement("span",null,ee===t?t:"")))}return We()}const Kt={minWidth:50,width:150,maxWidth:400,Cell:Bt,Header:Gt,sortType:"alphanumericFalsyLast"};function Zt({columns:t,data:l,dispatch:n,skipReset:a}){const r=E.exports.useMemo(()=>({alphanumericFalsyLast(o,d,u,g){return o.values[t[0].id]===te||d.values[t[0].id]===te?g?-1:1:!o.values[u]&&!d.values[u]?0:o.values[u]?d.values[u]?isNaN(o.values[u])?o.values[u].localeCompare(d.values[u]):o.values[u]-d.values[u]:g?1:-1:g?-1:1}}),[]),{getTableProps:s,getTableBodyProps:f,headerGroups:p,rows:x,prepareRow:y,totalColumnsWidth:L}=K.exports.useTable({columns:t,data:l,defaultColumn:Kt,dataDispatch:n,autoResetSortBy:!a,autoResetFilters:!a,autoResetRowState:!a,sortTypes:r},K.exports.useBlockLayout,K.exports.useResizeColumns,K.exports.useSortBy);function c(){for(let o of p)for(let d of o.headers)if(d.isResizing)return!0;return!1}return e.createElement("div",{className:"overflow-y-hidden",style:{width:"auto",height:"100%"}},e.createElement("div",b(T({},s()),{className:it("custom-table",c()&&"noselect")}),p.map((o,d)=>e.createElement("div",b(T({},o.getHeaderGroupProps()),{className:"tr",key:d}),o.headers.map((u,g)=>e.createElement("div",{key:g},u.render("Header"))))),e.createElement("div",T({},f()),x.map((o,d)=>(y(o),e.createElement("div",b(T({key:d},o.getRowProps()),{className:"tr"}),o.cells.map(u=>e.createElement("div",b(T({},u.getCellProps()),{className:"td"}),u.render("Cell")))))))),e.createElement("div",{id:"popper-portal"}))}const qt={flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#9b9b9b",outline:"none",transition:"border .24s ease-in-out",minHeight:"250px"},Jt={borderColor:"#2196f3"},Qt={borderColor:"#00e676"},el={borderColor:"#ff1744"};function tl({uploadFile:t}){const[l,n]=E.exports.useState(!1),a=E.exports.useCallback(c=>{n(!0),t(c[0])},[]),r=E.exports.useCallback(c=>{n(!1),ue.error("Only support *.xlsx and *.xls files")}),{getRootProps:s,getInputProps:f,isDragActive:p,isDragAccept:x,isDragReject:y}=mt({onDrop:a,onDropRejected:r,maxFiles:1,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"}),L=E.exports.useMemo(()=>T(T(T(T({},qt),p?Jt:{}),x?Qt:{}),y?el:{}),[p,y,x]);return e.createElement(e.Fragment,null,e.createElement("div",b(T({},s({style:L})),{className:"cursor-pointer"}),l?e.createElement("div",{className:"d-flex justify-content-center align-items-center"},e.createElement(dt,{animation:"border",role:"status"},e.createElement("span",{className:"visually-hidden"},"Loading...")),e.createElement("div",{className:"ms-2"},"Loading...")):e.createElement(e.Fragment,null,e.createElement("input",T({},f())),p?e.createElement("p",null,"Drop the files here ..."):e.createElement(e.Fragment,null,e.createElement("p",null,"Drag 'n' drop some files here, or click to select excel files"),e.createElement("em",null,"(Only *.xlsx and *.xls files will be accepted)")))),e.createElement(be,null))}const ll=()=>{const[t,l]=E.exports.useReducer(Rt,pe()),[n,a]=E.exports.useState(!0),r=E.exports.useRef(null);E.exports.useEffect(()=>{l({type:m.ENABLE_RESET})},[t.data,t.columns]);const s=()=>{l({type:m.ADD_COLUMN_TO_LEFT,columnId:999999,focus:!0})},f=()=>{l({type:m.ADD_ROW}),l({type:m.CLONE_PREVIOUS_DATA})},p=()=>{var u;(u=r.current)==null||u.click()},x=()=>{l({type:m.DOWNLOAD_TO_SHEET})},y=()=>{var u,g;return L((g=(u=r.current)==null?void 0:u.files)==null?void 0:g[0])},L=E.exports.useCallback(async u=>{if(!!u)try{const g=await pt.onFileSelection(u);let v=Object.keys(g)[0],A=g[v],I=Ce(A);a(!1),l({type:m.INITIALIZE_DATA,payload:I}),ue.success("Successfully Parsed.")}catch{ue.error("Please upload a valid xlsx file with data!"),l({type:m.INITIALIZE_DATA,payload:Ce([])})}},[]),c=()=>{let u=Ce([],Q.NEW_SHEET);a(!0),l({type:m.INITIALIZE_DATA,payload:u})},o=u=>{l({type:m.FILTER_BY_OPTIONS,filters:u}),l({type:m.TOTAL_SUM_CALCULATION})},d=()=>{l({type:m.INITIALIZE_DATA,payload:pe()})};return e.createElement(e.Fragment,null,e.createElement(ie,{fluid:!0},e.createElement(Z,{className:"pt-4 my-4"},e.createElement("h1",{className:"d-flex justify-content-center align-items-center"},e.createElement(O,{icon:"file-excel",className:"mr-2"}),ht)),t.data.length?e.createElement(ie,{fluid:!0},e.createElement(Z,null,e.createElement("div",{className:"mb-2 d-flex justify-content-between align-items-center min-height-3rem"},e.createElement("div",null,e.createElement("input",{ref:r,className:"d-none",id:"uploadFile",name:"uploadFile",onChange:y,type:"file",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"}),e.createElement(F,{onClick:p,variant:"success",className:"mr-4"},e.createElement(O,{icon:"upload",className:"mr-2"}),"Upload New XLSX"),e.createElement(F,{variant:"primary",className:"mr-4",onClick:x},e.createElement(O,{icon:"download",className:"mr-2"}),"Download XLSX"),e.createElement(F,{variant:"outline-success",onClick:f,className:"mr-4"},e.createElement(O,{icon:"plus",className:"mr-2"}),"Add Row"),e.createElement(F,{variant:"outline-primary",onClick:s},e.createElement(O,{icon:"plus",className:"mr-2"}),"Add Column")),e.createElement("div",{className:"d-inline-block"},e.createElement("div",{className:"d-flex align-items-center"},n&&e.createElement("div",{className:"mr-4 d-flex"},e.createElement(Et.exports.Multiselect,{options:t.filterOptions,selectedValues:t.selectedFilterValue,avoidHighlightFirstOption:!0,placeholder:"Filters",onSelect:o,onRemove:o,displayValue:"name"})),e.createElement(F,{variant:"light",onClick:d},e.createElement(O,{icon:"redo",className:"mr-2"}),"RESET"))))),e.createElement(Z,{style:{overflow:"auto",display:"flex"}},e.createElement(q,{style:{flex:"1 1 auto",padding:"1rem"}},e.createElement(Zt,{columns:t.columns,data:t.data,dispatch:l,skipReset:t.skipReset})))):e.createElement(ie,null,e.createElement(Z,{className:"my-4 d-flex flex-column justify-content-center"},e.createElement(q,null,e.createElement(tl,{uploadFile:L})),e.createElement(q,{className:"my-5 text-center text-black-50 font-weight-600 font-size-120"},e.createElement("div",{className:"border-line"},"OR")),e.createElement(q,{className:"mb-4 text-center"},e.createElement(F,{variant:"success",onClick:c},e.createElement(O,{icon:"plus",className:"mr-2"}),"Create a New Sheet"))))),e.createElement(be,null))};ft.render(e.createElement(e.StrictMode,null,e.createElement(ll,null)),document.getElementById("root"));
